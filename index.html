<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Analysis Dashboard - Gunn Jaggi</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: #fff;
            color: #000;
        }

        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255,255,255,0.95);
            border-bottom: 1px solid #e5e5e5;
            padding: 1rem 2rem;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
        }

        nav a {
            text-decoration: none;
            color: #000;
            font-weight: 600;
        }

        .hero {
            margin-top: 80px;
            padding: 5rem 2rem;
            background: linear-gradient(-45deg, #000, #1a1a1a);
            color: white;
        }

        .content {
            max-width: 1200px;
            margin: auto;
            padding: 3rem 2rem;
        }

        .section {
            border: 1px solid #e5e5e5;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        input, button {
            padding: 1rem;
            font-size: 1rem;
        }

        button {
            cursor: pointer;
            background: #000;
            color: white;
            border: none;
            border-radius: 6px;
        }

        .hidden {
            display: none;
        }

        .metric {
            font-size: 1.5rem;
            font-weight: 700;
        }

        canvas {
            max-width: 100%;
            height: 400px;
        }
    </style>
</head>

<body>

<nav>
    <a href="https://gunnjaggi.github.io/GunnJaggi/index.html">Gunn Jaggi</a>
    <a href="https://gunnjaggi.github.io/GunnJaggi/index.html#projects">Back to Projects</a>
</nav>

<section class="hero">
    <h1>Stock Analysis Dashboard</h1>
    <p>Real-time stock prices and technical analysis using Yahoo Finance data.</p>
</section>

<div class="content">

    <div class="section">
        <input id="stockSymbol" placeholder="Enter stock symbol (AAPL, TSLA, NVDA)" />
        <button onclick="analyzeStock()">Analyze</button>
    </div>

    <div id="loading" class="section hidden">
        Loading real stock data...
    </div>

    <div id="results" class="hidden">

        <div class="section">
            <h2 id="symbolTitle"></h2>
            <div class="metric" id="price"></div>
            <div id="change"></div>
        </div>

        <div class="section">
            <canvas id="chart"></canvas>
        </div>

    </div>

</div>

<script>
let chart;

async function analyzeStock() {
    const symbol = document.getElementById("stockSymbol").value.toUpperCase();
    if (!symbol) return alert("Enter a symbol");

    document.getElementById("loading").classList.remove("hidden");
    document.getElementById("results").classList.add("hidden");

    try {
        const res = await fetch(
            `https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?range=1mo&interval=1d`
        );
        const json = await res.json();
        const result = json.chart.result[0];

        const prices = result.indicators.quote[0].close.filter(x => x !== null);
        const timestamps = result.timestamp.slice(-prices.length);

        const dates = timestamps.map(t =>
            new Date(t * 1000).toISOString().split("T")[0]
        );

        const current = prices[prices.length - 1];
        const prev = prices[prices.length - 2];
        const change = current - prev;
        const pct = (change / prev) * 100;

        document.getElementById("symbolTitle").innerText = symbol;
        document.getElementById("price").innerText = `$${current.toFixed(2)}`;
        document.getElementById("change").innerText =
            `${change >= 0 ? "+" : ""}${change.toFixed(2)} (${pct.toFixed(2)}%)`;

        drawChart(dates, prices);

        document.getElementById("loading").classList.add("hidden");
        document.getElementById("results").classList.remove("hidden");

    } catch (e) {
        alert("Failed to load stock data");
    }
}

function drawChart(labels, data) {
    const ctx = document.getElementById("chart");

    if (chart) chart.destroy();

    chart = new Chart(ctx, {
        type: "line",
        data: {
            labels,
            datasets: [{
                data,
                borderColor: "#0066ff",
                fill: false,
                tension: 0.2
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } }
        }
    });
}
</script>

</body>
</html>
